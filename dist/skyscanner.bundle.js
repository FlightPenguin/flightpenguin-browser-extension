(()=>{"use strict";function t(){chrome.runtime.sendMessage({event:"FOCUS_WEBPAGE"})}function e(t){chrome.runtime.sendMessage({event:"NO_FLIGHTS_FOUND",provider:t})}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var i=/\.(?:(?:[\x2D0-9A-Z_a-z\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\\(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+/,a=/#(?:(?:[\x2D0-9A-Z_a-z\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\\(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+/,u=/\[[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*((?:(?:\*|[\x2D0-9A-Z_a-z]*)\|)?(?:(?:[\x2D0-9A-Z_a-z\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+))/g,c={};function l(t){var e=c[t];if(e)return e;e=c[t]={attributes:!0,subtree:!0,childList:!0};var o,l=[],s=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=n(t))){r&&(t=r);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){c=!0,a=t},f:function(){try{u||null==r.return||r.return()}finally{if(c)throw a}}}}(t.matchAll(u));try{for(s.s();!(o=s.n()).done;){var f=r(o.value,2)[1];if(f.startsWith("*")||f.startsWith("|"))return e;l.push(f.replace("|",":"))}}catch(t){s.e(t)}finally{s.f()}return i.test(t)&&l.push("class"),a.test(t)&&l.push("id"),0===l.length?e.attributes=!1:e.attributeFilter=l,e}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.timeout,n=void 0===r?2500:r,o=e.scope,i=void 0===o?document:o;return new Promise((function(e){var r=i.querySelector(t);if(null===r){var o=null,a=new MutationObserver((function(){var r=i.querySelector(t);null!==r&&(clearTimeout(o),a.disconnect(),e(r))}));a.observe(i,l(t)),o=setTimeout((function(){a.disconnect(),e(null)}),n)}else e(r)}))}function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.timeout,n=void 0===r?2500:r,o=e.scope,i=void 0===o?document:o;return new Promise((function(e){var r=null;if(null!==i.querySelector(t)){var o=new MutationObserver((function(){null===i.querySelector(t)&&(clearTimeout(r),o.disconnect(),e(!0))}));o.observe(i,l(t)),r=setTimeout((function(){o.disconnect(),e(!1)}),n)}else e(!0)}))}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}function p(t){var e=w();return function(){var r,n=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(t){var e="function"==typeof Map?new Map:void 0;return(m=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return b(t,arguments,g(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),A(n,t)})(t)}function b(t,e,r){return(b=w()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&A(o,r.prototype),o}).apply(null,arguments)}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var F=function(t){v(r,t);var e=p(r);function r(t){return y(this,r),e.call(this,t)}return r}(function(t){v(r,t);var e=p(r);function r(t){var n;return y(this,r),(n=e.call(this)).message=t,n.stack=(new Error).stack,n.name=n.constructor.name,n}return r}(m(Error))),S=function(t){v(r,t);var e=p(r);function r(t){return y(this,r),e.call(this,t)}return r}(F),D=function(t){v(r,t);var e=p(r);function r(t){return y(this,r),e.call(this,t)}return r}(F),C=function(t){v(r,t);var e=p(r);function r(t){return y(this,r),e.call(this,t)}return r}(F);function E(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function x(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){E(i,n,o,a,u,"next",t)}function u(t){E(i,n,o,a,u,"throw",t)}a(void 0)}))}}var P=function(){var t=x((function*(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.document;if(r.querySelector(e)){var n=yield f(e,{timeout:t,scope:r});if(!n)throw new S("Took longer than ".concat(t," ms to make the loading indicator (").concat(e,") disappear"))}}));return function(e,r){return t.apply(this,arguments)}}(),O=function(){var t=x((function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3,e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.document,n=r.querySelector(e);if(!n&&!(n=yield s(e,{timeout:t,scope:r})))throw new S("Render of ".concat(e," failed to complete in ").concat(t));return n}));return function(){return t.apply(this,arguments)}}();function T(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var I=function(){var t,e=(t=function*(){var t=document.querySelectorAll("iframe");if(!t)throw new C("Unable to locate iframes in captcha page");for(var e=0;e<t.length;e++)window[e].document.body.dispatchEvent(new Event("mousedown"));yield O(15e3,"#pagewrap")},function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){T(i,n,o,a,u,"next",t)}function u(t){T(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}(),j=function(t){return t.toLowerCase().replace(" ","").trim()};const _={airlineDetailsMap:{"American Airlines":{display:"American",color:"#C5423E",code:"AA"},American:{display:"American",color:"#C5423E",code:"AA"},Delta:{display:"Delta",color:"#EE722E",code:"DL"},Southwest:{display:"Southwest",color:"#F6C04D",code:"WN"},United:{display:"United",color:"#235EA6",code:"UA"},"Air Canada":{display:"Air Canada",color:"#E53222",code:"AC"},"Alaska Airlines":{display:"Alaska",color:"#51172C",code:"AS"},jetBlue:{display:"jetBlue",color:"#5F90C8",code:"B6"},"JetBlue Airways":{display:"jetBlue",color:"#5F90C8",code:"B6"},"Spirit Airlines":{display:"Spirit",color:"#BBB140",code:"NK"},WestJet:{display:"WestJet",color:"#4BA89C",code:"WS"},Aeromexico:{display:"Aeromexico",color:"#000000",code:"AM"},"Frontier Airlines":{display:"Frontier",color:"#378055",code:"F9"},Interjet:{display:"Interjet",color:"#A8A8A8",code:"4O"},"Hawaiian Airlines":{display:"Hawaiian",color:"#4D388A",code:"HA"},"Sun Country Airlines":{display:"Sun Country",color:"#D79A71",code:"SY"},"Porter Airlines":{display:"Porter",color:"#0F2B53",code:"PD"},"China Southern Airlines":{display:"China Southern",color:"#93ACCA",code:"CZ"},Lufthansa:{display:"Lufthansa",color:"#EFB95D",code:"LH"},SWISS:{display:"Swiss",color:"#D42D21",code:"LX"},"China Eastern Airlines":{display:"China Eastern",color:"#A9545F",code:"MU"},"British Airways":{display:"British",color:"#EA8E8C",code:"BA"},Iberia:{display:"Iberia",color:"#D05653",code:"IB"},"Air China":{display:"Air China",color:"#DF524B",code:"CA"},"Emirates Airlines":{display:"Emirates",color:"#CF534F",code:"EK"},"KLM-Royal Dutch Airlines":{display:"KLM",color:"#44A0DC",code:"KL"},"Air France":{display:"Air France",color:"#DB3832",code:"AF"},"Turkish Airlines":{display:"Turkish",color:"#DB3832",code:"TK"},"Cathay Pacific":{display:"Cathay",color:"#2A645A",code:"CX"},"Cathay Dragon":{display:"Cathay",color:"#2A645A",code:"CX"},"EVA Airways":{display:"EVA",color:"#6F9F64",code:"BR"},"China Airlines":{display:"China Airlines",color:"#DAABB1",code:"CI"},"ANA Airlines":{display:"ANA",color:"#254897",code:"NH"},"Japan Airlines":{display:"Japan Airlines",color:"#E56E69",code:"JL"},"Air India":{display:"Air India",color:"#D47346",code:"AI"},"Qantas Airways":{display:"Qantas",color:"#E34538",code:"QF"},"Singapore Airlines":{display:"Sinagpore",color:"#EFA952",code:"SQ"},"ANA (All Nippon Airways)":{display:"ANA",color:"#0f4a8d"}},getAirlineName:function(t){if(t&&"string"==typeof t){var e=t.trim(),r=this.airlineDetailsMap[e];return r&&(e=r.display),e}},getAirlineDetails:function(t){var e=t.trim();return this.airlineDetailsMap[e]||{display:e,color:"#DFCCFB"}}};function B(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return U(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function L(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var k=function(){var t,e=(t=function*(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=document.createElement("iframe"),a="iframe";if(n&&(i.id=n,a+="#id"),o){var u,c=B(o);try{for(c.s();!(u=c.n()).done;){var l=u.value;i.classList.add(l),a+=".".concat(l)}}catch(t){c.e(t)}finally{c.f()}}i.src=e,i.style.display="none",i.dataset.loaded="false",i.onload=function(t){if(!(t.target instanceof HTMLIFrameElement))throw new Error("Unable to resolve iframe");t.target.dataset.loaded="true"},t.appendChild(i),a+="[data-loaded='true']";var s=yield O(r,a);if(!s.contentDocument)throw new F("Unable to access content document of iframe");return s.contentDocument},function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){L(i,n,o,a,u,"next",t)}function u(t){L(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t,r){return e.apply(this,arguments)}}();function R(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function q(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){R(i,n,o,a,u,"next",t)}function u(t){R(i,n,o,a,u,"throw",t)}a(void 0)}))}}var M="invisible_layovers",N=".".concat(M),H=function(){var t=q((function*(t){var e=yield G(t),r=yield k(t,e,15e3,"",[M]);return yield P(15e3,"[class*='DetailsPanel_loading']",r),r}));return function(e){return t.apply(this,arguments)}}(),W=function(){var t=q((function*(t){var e,r=t.querySelector(N);r&&(null===(e=r.parentElement)||void 0===e||e.removeChild(r),yield P(1e4,N))}));return function(e){return t.apply(this,arguments)}}(),G=function(){var t=q((function*(t){var e=t.closest("a[class*='FlightsTicket_link']");if(!e)throw new C("Unable to find layovers link");return e.href}));return function(e){return t.apply(this,arguments)}}();function J(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||K(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(t,e){if(t){if("string"==typeof t)return $(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(t,e):void 0}}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var V=function(t){var e;null===(e=t.querySelector("button"))||void 0===e||e.click(),O(500,"[class*='LegSegmentSummary_container']",t);var r,n=[],o={},i=function(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=K(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(t.querySelectorAll("[class*='AirlineLogoTitle_container'],[class*='LegSegmentDetails_container']"));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.className.startsWith("Airline")){var u=Z(a).operatingAirline;o.operatingAirline=u}else{if(!a.className.startsWith("LegSeg"))throw new F("Unexpected case: ".concat(a.className));var c=z(a),l=c.arrivalTime,s=c.departureTime,f=c.duration,d=Q(a),y=d.arrivalAirport,v=d.departureAirport;o.duration=f,o.from=v,o.to=y,o.fromTime=s,o.toTime=l,n.push(o),o={}}}}catch(t){i.e(t)}finally{i.f()}return n},Z=function(t){var e,r,n=J(t.querySelectorAll("span"),2),o=n[0],i=n[1];if(!o)throw new C("Unable to find marketing airline container");var a=null===(e=o.textContent)||void 0===e?void 0:e.trim(),u=i&&null!==(r=i.textContent)&&void 0!==r&&r.toLowerCase().includes("operated")?i.textContent.split("|")[1].trim():a;if(!a)throw new D("Unable to determine marketing airline");if(!u)throw new D("Unable to determine operating airline");return{marketingAirline:a,operatingAirline:u}},z=function(t){var e=t.querySelector("[class*='Times_segment']");if(!e)throw new C("Unable to determine times of layover");var r=J(e.querySelectorAll("span"),3),n=r[0],o=r[1],i=r[2],a=n.textContent;if(!n)throw new D("Couldn't parse departure time of layover");var u=o.textContent;if(!u)throw new D("Couldn't parse duration of layover");var c=i.textContent;if(!c)throw new D("Couldn't parse arrival time of layover");return{departureTime:j(a),arrivalTime:j(c),duration:u}},Q=function(t){var e,r,n=t.querySelector("[class*='Routes_route']");if(!n)throw new C("Unable to determine airports of layover");var o=J(n.querySelectorAll("span"),2),i=o[0],a=o[1],u=null===(e=i.textContent)||void 0===e?void 0:e.split(/\s+/)[0].trim();if(!u)throw new D("Couldn't parse departure airport of layover");var c=null===(r=a.textContent)||void 0===r?void 0:r.split(/\s+/)[0].trim();if(!c)throw new D("Couldn't parse arrival airport of layover");return{arrivalAirport:c,departureAirport:u}};function X(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function et(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){tt(i,n,o,a,u,"next",t)}function u(t){tt(i,n,o,a,u,"throw",t)}a(void 0)}))}}var rt=function(){var t=et((function*(t){var e=X((yield nt(t)).querySelectorAll("[class*='Itinerary_leg']"),2),r=e[0],n=e[1],o=V(r),i=V(n);return yield ot(t),{departureLayovers:o,returnLayovers:i}}));return function(e){return t.apply(this,arguments)}}(),nt=function(){var t=et((function*(t){return yield H(t)}));return function(e){return t.apply(this,arguments)}}(),ot=function(){var t=et((function*(t){yield W(t)}));return function(e){return t.apply(this,arguments)}}();function it(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function at(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?it(Object(r),!0).forEach((function(e){ut(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ut(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ct(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var lt=/\d{1,2} stop/,st=function(){var t,e=(t=function*(t){var e=dt(t),r=yt(t)?{departureLayovers:[],returnLayovers:[]}:yield rt(t),n=r.departureLayovers,o=r.returnLayovers,i=vt(t,"DEPARTURE"),a=vt(t,"ARRIVAL");return ft(t),{departureFlight:at(at({},i),{},{layovers:n}),returnFlight:at(at({},a),{},{layovers:o}),fare:e}},function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ct(i,n,o,a,u,"next",t)}function u(t){ct(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}(),ft=function(t){t.dataset.visited="true"},dt=function(t){var e=t.querySelector("[class*='TotalPrice_totalPriceContainer'],[class*='Price_mainPriceContainer'],[class*='CardPrice_totalPrice']");if(!e)throw new C("Unable to find fare in card");return e.textContent},yt=function(t){return!lt.test(t.textContent||"")},vt=function(t,e){var r="DEPARTURE"===e?0:1,n=t.querySelectorAll("[class*='UpperTicketBody_leg__']")[r];if(!n)throw new C("Unable to locate ".concat(e," container"));return{marketingAirline:pt(n),operatingAirline:ht(n),fromTime:mt(n,"DEPARTURE"),toTime:mt(n,"ARRIVAL"),duration:bt(n)}},pt=function(t){var e,r=t.querySelector("[class*='LogoImage_container__']");if(!r)throw new C("Unable to locate marketing airline container");var n=null===(e=r.textContent)||void 0===e?void 0:e.trim();if(!n){var o=r.querySelector("img");if(o.alt&&(n=o.alt),!n)throw new D("Unable to extract marketing airline name")}return _.getAirlineName(n)},ht=function(t){var e,r=t.querySelector("[class*='Operators_operator']");if(!r){var n;if(null!==(n=t.textContent)&&void 0!==n&&n.toLowerCase().includes("operated by"))throw new C("Unable to locate operating airline container");return null}var o=null===(e=r.textContent)||void 0===e?void 0:e.trim();if(!o)throw new D("Unable to extract operating airline name");return _.getAirlineName(o)},mt=function(t,e){var r,n="DEPARTURE"===e?0:1,o=t.querySelectorAll("span[class*='LegInfo_routePartialTime__']")[n];if(!o)throw new C("Unable to find ".concat(e," time container"));var i=null===(r=o.textContent)||void 0===r?void 0:r.trim();if(!i)throw new C("Unable to determine ".concat(e," time"));return j(i)},bt=function(t){var e,r=t.querySelector("span[class*='Duration_duration']");if(!r)throw new C("Unable to find duration time container");var n=null===(e=r.textContent)||void 0===e?void 0:e.trim();if(!n)throw new C("Unable to determine duration time");return n};function wt(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return At(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return At(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var Ft="span[class*=SummaryInfo_itineraryCountContainer]",St="[class*='FlightsTicket_container'] [role='button']:not([data-visited='true'])",Dt=function(){var t,e=(t=function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4;if(yield O(t,"body"),Ct()&&I(),yield O(t,Ft),Et())return[];var e,r=[],n=document.querySelectorAll(St),o=wt(n);try{for(o.s();!(e=o.n()).done;){var i=e.value;if(!xt(i)){var a=yield st(i);Pt(i,a),r.push(a)}}}catch(t){o.e(t)}finally{o.f()}return r},function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){gt(i,n,o,a,u,"next",t)}function u(t){gt(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}(),Ct=function(){return!!document.querySelector("#px-captcha")},Et=function(){return!!document.querySelector("div[class*=FallbackNoResults_container]")},xt=function(t){return["sponsored"].some((function(e){var r;return null===(r=t.textContent)||void 0===r?void 0:r.includes(e)}))},Pt=function(t,e){var r=Ot(e.departureFlight),n=Ot(e.returnFlight);t.dataset.fpid="".concat(r,"-").concat(n)},Ot=function(t){return[t.fromTime,t.toTime,t.marketingAirline].join("-")};function Tt(){var t=document.querySelector("button[class*='close-button']");t&&t.click()}function It(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function jt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){It(i,n,o,a,u,"next",t)}function u(t){It(i,n,o,a,u,"throw",t)}a(void 0)}))}}var _t="[class*='FlightsTicket_container'] [role='button']:not([data-visited='true'])",Bt=function(){var t=jt((function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7500;yield Ut(t),window.scrollTo(window.scrollX,document.body.offsetHeight),yield O(t,_t)}));return function(){return t.apply(this,arguments)}}(),Ut=function(){var t=jt((function*(t){var e=Lt();e&&(e.classList.add("fp-showMoreResults"),e.click(),yield P(t,".fp-showMoreResults"))}));return function(e){return t.apply(this,arguments)}}(),Lt=function(){return Array.from(document.querySelectorAll("button")).find((function(t){return"Show more results"===t.textContent}))};function kt(t){return function(t){if(Array.isArray(t))return Rt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Rt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var Mt="[data-selected='true']",Nt=function(){var t,e=(t=function*(t,e){Ht();var r,n=Wt(t,e);(r=n).style.border="10px solid #f2554b",r.style.borderRadius="6px",r.style.paddingTop="25px",r.style.paddingBottom="25px",r.dataset.selected="true",Gt(n)},function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){qt(i,n,o,a,u,"next",t)}function u(t){qt(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t,r){return e.apply(this,arguments)}}(),Ht=function(){var t,e=document.querySelector(Mt);e&&((t=e).dataset.selected="false",t.style.border="",t.style.paddingTop="0px",t.style.paddingBottom="0px",t.style.borderRadius="0px")},Wt=function(t,e){var r=document.querySelectorAll("[class*='FlightsTicket_container'] [role='button']");if(!r)throw new F("Unable to find flights in highlighting");var n,o,i="".concat(t,"-").concat(e),a=(n=kt(r),o=i,n.find((function(t){return t.dataset.fpid===o})));if(!a)throw new C("Unable to find flight to highlight");return a},Gt=function(t){var e=window.pageYOffset+t.getBoundingClientRect().top-window.innerHeight/2;window.scroll(0,e)};function Jt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Kt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Jt(i,n,o,a,u,"next",t)}function u(t){Jt(i,n,o,a,u,"throw",t)}a(void 0)}))}}window.Sentry.init({dsn:"https://d7f3363dd3774a64ad700b4523bcb789@o407795.ingest.sentry.io/5277451"});var $t=!0;chrome.runtime.onMessage.addListener(function(){var e=Kt((function*(e){switch(e.event){case"BEGIN_PARSING":yield Vt();break;case"HIGHLIGHT_FLIGHT":$t=!1,Tt(),yield Nt(e.selectedDepartureId,e.selectedReturnId),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#back-to-search";if(!document.querySelector(e)){var r=document.createElement("button");r.id="back-to-search",r.textContent="Return to FlightPenguin",r.title="Click to return to FlightPenguin and keep browsing.",r.addEventListener("click",t),document.body.append(r)}}()}}));return function(t){return e.apply(this,arguments)}}());var Vt=function(){var t=Kt((function*(){var t,r,n=0,o=!0;try{for(;n<60&&o&&$t;){Tt();var i=yield Dt();i?(t="skyscanner",r=i,chrome.runtime.sendMessage({event:"FLIGHT_RESULTS_RECEIVED",flights:r,provider:t}),n+=i.length,yield Bt()):0===n?(e("skyscanner"),o=!1):o=!1}}catch(t){window.Sentry.captureException(t),n||function(t,e){chrome.runtime.sendMessage({event:"FAILED_SCRAPER",source:t,description:"".concat(e.name," ").concat(e.message)})}("skyscanner",t)}}));return function(){return t.apply(this,arguments)}}()})();