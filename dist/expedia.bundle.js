(()=>{"use strict";var t={608:function(t,r){var e,n=this&&this.__extends||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});r.__esModule=!0,r.MissingElementLookupError=r.MissingFieldParserError=r.LoadingTimeoutParserError=r.ParserError=void 0;var o=function(t){function r(r){return t.call(this,r)||this}return n(r,t),r}(function(t){function r(r){var e=t.call(this)||this;return e.message=r,e.stack=(new Error).stack,e.name=e.constructor.name,e}return n(r,t),r}(Error));r.ParserError=o;var i=function(t){function r(r){return t.call(this,r)||this}return n(r,t),r}(o);r.LoadingTimeoutParserError=i;var a=function(t){function r(r){return t.call(this,r)||this}return n(r,t),r}(o);r.MissingFieldParserError=a;var u=function(t){function r(r){return t.call(this,r)||this}return n(r,t),r}(o);r.MissingElementLookupError=u}},r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{}};return t[n].call(o.exports,o,o.exports,e),o.exports}(()=>{function t(){chrome.runtime.sendMessage({event:"FOCUS_WEBPAGE"})}function r(t,r){chrome.runtime.sendMessage({event:"FAILED_SCRAPER",source:t,description:"".concat(r.name," ").concat(r.message)})}function n(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,i=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(n=e.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw o}}return i}}(t,r)||o(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,r){if(t){if("string"==typeof t)return i(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,r):void 0}}function i(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var a=/\.(?:(?:[\x2D0-9A-Z_a-z\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\\(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+/,u=/#(?:(?:[\x2D0-9A-Z_a-z\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\\(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+/,l=/\[[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*((?:(?:\*|[\x2D0-9A-Z_a-z]*)\|)?(?:(?:[\x2D0-9A-Z_a-z\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+))/g,c={};function s(t){var r=c[t];if(r)return r;r=c[t]={attributes:!0,subtree:!0,childList:!0};var e,i=[],s=function(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=o(t))){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,l=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){l=!0,a=t},f:function(){try{u||null==e.return||e.return()}finally{if(l)throw a}}}}(t.matchAll(l));try{for(s.s();!(e=s.n()).done;){var d=n(e.value,2)[1];if(d.startsWith("*")||d.startsWith("|"))return r;i.push(d.replace("|",":"))}}catch(t){s.e(t)}finally{s.f()}return a.test(t)&&i.push("class"),u.test(t)&&i.push("id"),0===i.length?r.attributes=!1:r.attributeFilter=i,r}function d(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=r.timeout,n=void 0===e?2500:e,o=r.scope,i=void 0===o?document:o;return new Promise((function(r){var e=i.querySelector(t);if(null===e){var o=null,a=new MutationObserver((function(){var e=i.querySelector(t);null!==e&&(clearTimeout(o),a.disconnect(),r(e))}));a.observe(i,s(t)),o=setTimeout((function(){a.disconnect(),r(null)}),n)}else r(e)}))}function f(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=r.timeout,n=void 0===e?2500:e,o=r.scope,i=void 0===o?document:o;return new Promise((function(r){var e=null;if(null!==i.querySelector(t)){var o=new MutationObserver((function(){null===i.querySelector(t)&&(clearTimeout(e),o.disconnect(),r(!0))}));o.observe(i,s(t)),e=setTimeout((function(){o.disconnect(),r(!1)}),n)}else r(!0)}))}var y=e(608),v="button[data-icon='tool-close']",p=function(){var t=document.querySelector(v);if(!t)throw new y.MissingElementLookupError("Unable to find modal close element via ".concat(v));t.click()},h=function(t){return t.toLowerCase().replace(" ","").trim()};const m={airlineDetailsMap:{"American Airlines":{display:"American",color:"#C5423E",code:"AA"},American:{display:"American",color:"#C5423E",code:"AA"},Delta:{display:"Delta",color:"#EE722E",code:"DL"},Southwest:{display:"Southwest",color:"#F6C04D",code:"WN"},United:{display:"United",color:"#235EA6",code:"UA"},"Air Canada":{display:"Air Canada",color:"#E53222",code:"AC"},"Alaska Airlines":{display:"Alaska",color:"#51172C",code:"AS"},jetBlue:{display:"jetBlue",color:"#5F90C8",code:"B6"},"JetBlue Airways":{display:"jetBlue",color:"#5F90C8",code:"B6"},"Spirit Airlines":{display:"Spirit",color:"#BBB140",code:"NK"},WestJet:{display:"WestJet",color:"#4BA89C",code:"WS"},Aeromexico:{display:"Aeromexico",color:"#000000",code:"AM"},"Frontier Airlines":{display:"Frontier",color:"#378055",code:"F9"},Interjet:{display:"Interjet",color:"#A8A8A8",code:"4O"},"Hawaiian Airlines":{display:"Hawaiian",color:"#4D388A",code:"HA"},"Sun Country Airlines":{display:"Sun Country",color:"#D79A71",code:"SY"},"Porter Airlines":{display:"Porter",color:"#0F2B53",code:"PD"},"China Southern Airlines":{display:"China Southern",color:"#93ACCA",code:"CZ"},Lufthansa:{display:"Lufthansa",color:"#EFB95D",code:"LH"},SWISS:{display:"Swiss",color:"#D42D21",code:"LX"},"China Eastern Airlines":{display:"China Eastern",color:"#A9545F",code:"MU"},"British Airways":{display:"British",color:"#EA8E8C",code:"BA"},Iberia:{display:"Iberia",color:"#D05653",code:"IB"},"Air China":{display:"Air China",color:"#DF524B",code:"CA"},"Emirates Airlines":{display:"Emirates",color:"#CF534F",code:"EK"},"KLM-Royal Dutch Airlines":{display:"KLM",color:"#44A0DC",code:"KL"},"Air France":{display:"Air France",color:"#DB3832",code:"AF"},"Turkish Airlines":{display:"Turkish",color:"#DB3832",code:"TK"},"Cathay Pacific":{display:"Cathay",color:"#2A645A",code:"CX"},"Cathay Dragon":{display:"Cathay",color:"#2A645A",code:"CX"},"EVA Airways":{display:"EVA",color:"#6F9F64",code:"BR"},"China Airlines":{display:"China Airlines",color:"#DAABB1",code:"CI"},"ANA Airlines":{display:"ANA",color:"#254897",code:"NH"},"Japan Airlines":{display:"Japan Airlines",color:"#E56E69",code:"JL"},"Air India":{display:"Air India",color:"#D47346",code:"AI"},"Qantas Airways":{display:"Qantas",color:"#E34538",code:"QF"},"Singapore Airlines":{display:"Sinagpore",color:"#EFA952",code:"SQ"},"ANA (All Nippon Airways)":{display:"ANA",color:"#0f4a8d"}},getAirlineName:function(t){if(t&&"string"==typeof t){var r=t.trim(),e=this.airlineDetailsMap[r];return e&&(r=e.display),r}},getAirlineDetails:function(t){var r=t.trim();return this.airlineDetailsMap[r]||{display:r,color:"#DFCCFB"}}};var g="[data-test-id='select-link']",A=function(t){var r=t.querySelector(g);if(!r)throw new y.MissingElementLookupError("Unable to find modal open element via ".concat(g));r.click()};function w(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}var b="summary",F=function(){var t,r=(t=function*(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,e=yield d(b,{timeout:r});if(!e)throw new y.MissingElementLookupError("Unable to find collapsible open element via ".concat(b));e.click()},function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){w(i,n,o,a,u,"next",t)}function u(t){w(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}();function E(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}var S="[data-test-id='details-and-fares']:not(:empty)",C=function(){var t,r=(t=function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,r=yield d(S,{timeout:t});if(!r)throw new y.MissingElementLookupError("Unable to locate modal after ".concat(t," ms"));return r},function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){E(i,n,o,a,u,"next",t)}function u(t){E(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();function D(t,r){return t.toLowerCase().includes("pm")&&r.toLowerCase().includes("am")}function x(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}(t,r)||function(t,r){if(!t)return;if("string"==typeof t)return k(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return k(t,r)}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var M=function(t,r,e){var n=x(t.children,3),o=n[0],i=n[1],a=n[2],u=I(o),l=P(a);return r>0&&D(null==e?void 0:e.toTime,u)?u+="+1":D(u,l)&&(l+="+1"),{fromTime:u,toTime:l,from:L(o),to:T(a),operatingAirline:U(null==i?void 0:i.children[1]),duration:B(null==i?void 0:i.children[0])}},P=function(t){var r,e=null===(r=t.textContent)||void 0===r?void 0:r.split(" - ")[0].toLowerCase().replace("arrival","");if(!e)throw new y.MissingFieldParserError("Unable to determine arrival time for layover");return h(e)},I=function(t){var r,e=null===(r=t.textContent)||void 0===r?void 0:r.split(" - ")[0].toLowerCase().replace("departure","");if(!e)throw new y.MissingFieldParserError("Unable to determine departure time for layover");return h(e)},T=function(t){var r,e,n,o,i,a=null===(r=t.textContent)||void 0===r?void 0:r.slice((null===(e=t.textContent)||void 0===e?void 0:e.indexOf("("))+1,null===(n=t.textContent)||void 0===n?void 0:n.indexOf(")"));3!==(null===(o=a)||void 0===o?void 0:o.length)&&(a=null===(i=t.textContent)||void 0===i?void 0:i.split("-")[1]);if(!a)throw new y.MissingFieldParserError("Unable to determine departure airport for layover");return a},L=function(t){var r,e,n,o,i,a=null===(r=t.textContent)||void 0===r?void 0:r.slice((null===(e=t.textContent)||void 0===e?void 0:e.indexOf("("))+1,null===(n=t.textContent)||void 0===n?void 0:n.indexOf(")"));3!==(null===(o=a)||void 0===o?void 0:o.length)&&(a=null===(i=t.textContent)||void 0===i?void 0:i.split("-")[1]);if(!a)throw new y.MissingFieldParserError("Unable to determine departure airport for layover");return a},B=function(t){var r,e=null==t||null===(r=t.textContent)||void 0===r?void 0:r.replace("flight","");if(!e)throw new y.MissingFieldParserError("Unable to determine duration time for layover");return e},U=function(t){var r,e,n=null==t||null===(r=t.textContent)||void 0===r||null===(e=r.match(/[A-z]*/g))||void 0===e?void 0:e.join(" ").trim();if(!n)throw new y.MissingFieldParserError("Unable to determine operating airline for layover");return n};function j(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}(t,r)||_(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,r){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=_(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function _(t,r){if(t){if("string"==typeof t)return q(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?q(t,r):void 0}}function q(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function N(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}var R="[data-test-id^='journey-section']",H=function(){var t,r=(t=function*(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,e=yield d(R,{timeout:r});if(!e)throw new y.MissingElementLookupError("Could not find ".concat(R," in modal after ").concat(r," ms"));var n=t.querySelectorAll(R);if(!n)throw new y.MissingElementLookupError("Could not find legs in modal");var o,i=[],a=O(n.entries());try{for(a.s();!(o=a.n()).done;){var u=j(o.value,2),l=u[0],c=u[1],s=M(c,l,i[i.length-1]);i.push(s)}}catch(t){a.e(t)}finally{a.f()}if(!i)throw new y.ParserError("Unable to identify layovers");return i},function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){N(i,n,o,a,u,"next",t)}function u(t){N(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}();function G(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}(t,r)||function(t,r){if(!t)return;if("string"==typeof t)return W(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return W(t,r)}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function $(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}var J=function(){var t,r=(t=function*(t){var r=K(t),e=r.marketingAirline,n=r.operatingAirline,o=z(t),i=o.departureTime,a=o.arrivalTime,u=Z(t),l=u.duration,c=u.hasStops;A(t);var s=yield C();return yield F(s),{marketingAirline:e,operatingAirline:n,fromTime:i,toTime:a,duration:l,layovers:c?yield H(s):[]}},function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){$(i,n,o,a,u,"next",t)}function u(t){$(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}(),K=function(t){var r,e,n,o=t.querySelector("[data-test-id='flight-operated']");if(!o)throw new y.MissingElementLookupError("Unable to lookup marketing airline");return o.childNodes.length>1?(e=o.childNodes[0],n=o.childNodes[1]):(e=o,n=null),{marketingAirline:m.getAirlineName(e.textContent),operatingAirline:n?null===(r=n.textContent)||void 0===r?void 0:r.split(/\s+operated\s+by\s+/)[1]:null}},z=function(t){var r,e=t.querySelector("[data-test-id='arrival-time']");if(!e)throw new y.MissingElementLookupError("Unable to lookup flight arrival time");var n=G((null===(r=e.textContent)||void 0===r?void 0:r.split(" - "))||[null,null],2),o=n[0],i=n[1];if(!o)throw new y.MissingFieldParserError("Unable to determine departure time for flight");if(!i)throw new y.MissingFieldParserError("Unable to determine arrival time for flight");return{arrivalTime:h(i),departureTime:h(o)}},Z=function(t){var r,e,n=t.querySelector("[data-test-id='journey-duration']");if(!n)throw new y.MissingElementLookupError("Unable to lookup flight duration time");var o=null===(r=n.textContent)||void 0===r?void 0:r.split("(")[0].trim(),i=!(null!==(e=n.textContent)&&void 0!==e&&e.includes("Nonstop"));if(!o)throw new y.MissingFieldParserError("Unable to determine duration time for flight");return{duration:o,hasStops:i}};function Q(t,r){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,r){if(!t)return;if("string"==typeof t)return V(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return V(t,r)}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function V(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function X(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}function Y(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){X(i,n,o,a,u,"next",t)}function u(t){X(i,n,o,a,u,"throw",t)}a(void 0)}))}}var tt="[data-test-id='loading-animation']",rt="[data-test-id='loading-more-flights']",et="[name='showMoreButton']",nt="[data-test-id='offer-listing']",ot=function(){var t=Y((function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;if(yield ct(r,tt),yield ct(r,rt),it())return[];yield at();var e,n=[],o=document.querySelectorAll(nt),i=Q(o);try{for(i.s();!(e=i.n()).done;){var a=e.value;if(!st(a)){var u=yield J(a),l=null,c=null,s=null;t?(l=t,c=u,s=yield lt(a)):(a.dataset.fpid=dt(u),l=u,s=yield ut()),n.push({departureFlight:l,returnFlight:c,fare:s}),p()}}}catch(t){i.e(t)}finally{i.f()}return n}));return function(){return t.apply(this,arguments)}}(),it=function(){return!!document.querySelector(".uitk-empty-state")},at=function(){var t=Y((function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4,r=document.querySelector(et);if(r){r.click();var e=yield f(et,{timeout:t});if(!e)throw new y.LoadingTimeoutParserError("Took longer than ${loadingTimeout} ms to load the show more flight results")}}));return function(){return t.apply(this,arguments)}}(),ut=function(){var t=Y((function*(){var t=(yield C()).querySelector("[data-test-id='fare-types-carousel'] .uitk-lockup-price");if(!t)throw new y.MissingElementLookupError("Unable to find fare in modal");return t.textContent}));return function(){return t.apply(this,arguments)}}(),lt=function(){var t=Y((function*(t){var r=t.querySelector(".uitk-price-subtext");if(!r)throw new y.MissingElementLookupError("Unable to find fare in card");return r.textContent}));return function(r){return t.apply(this,arguments)}}(),ct=function(){var t=Y((function*(t,r){if(document.querySelector(r)&&!(yield f(r,{timeout:t})))throw new y.LoadingTimeoutParserError("Took longer than ".concat(t," ms to make the loading indicator (").concat(r,") disappear"))}));return function(r,e){return t.apply(this,arguments)}}(),st=function(t){return["bargain fare","special fare","after booking"].some((function(r){var e;return null===(e=t.textContent)||void 0===e?void 0:e.includes(r)}))},dt=function(t){return[t.fromTime,t.toTime,t.marketingAirline].join("-")};function ft(t){return function(t){if(Array.isArray(t))return yt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,r){if(!t)return;if("string"==typeof t)return yt(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return yt(t,r)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function vt(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}var pt=function(){var t,r=(t=function*(t,r){yield ot(),ht();var e,n=mt(r);(e=n).style.border="10px solid #f2554b",e.style.borderRadius="6px",e.style.paddingTop="25px",e.style.paddingBottom="25px",e.dataset.selected="true",gt(n)},function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){vt(i,n,o,a,u,"next",t)}function u(t){vt(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t,e){return r.apply(this,arguments)}}(),ht=function(){var t,r=document.querySelector("[data-selected='true']");r&&((t=r).dataset.selected="false",t.style.border="",t.style.paddingTop="0px",t.style.paddingBottom="0px",t.style.borderRadius="0px")},mt=function(t){var r=document.querySelectorAll("[data-test-id='offer-listing']");if(!r)throw new y.ParserError("Unable to find flights in highlighting");var e,n,o=(e=ft(r),n=t,e.find((function(t){return t.dataset.fpid===n})));if(!o)throw new y.MissingElementLookupError("Unable to find flight to highlight");return o},gt=function(t){var r=window.pageYOffset+t.getBoundingClientRect().top-window.innerHeight/2;window.scroll(0,r)};function At(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}var wt=function(){var t,r=(t=function*(t){var r=document.querySelector("[data-fpid='".concat(t.id,"']"));if(!(r||(yield ot(),r=document.querySelector("[data-fpid='".concat(t.id,"']")))))throw new y.MissingElementLookupError("Unable to lookup departure flight");A(r);var e=yield C();bt(e)},function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){At(i,n,o,a,u,"next",t)}function u(t){At(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}(),bt=function(t){var r=t.querySelector("[data-test-id='select-button']");if(!r)throw new y.MissingElementLookupError("Unable to find select button");r.click()};function Ft(t,r,e,n,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void e(t)}u.done?r(l):Promise.resolve(l).then(n,o)}function Et(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Ft(i,n,o,a,u,"next",t)}function u(t){Ft(i,n,o,a,u,"throw",t)}a(void 0)}))}}window.Sentry.init({dsn:"https://d7f3363dd3774a64ad700b4523bcb789@o407795.ingest.sentry.io/5277451"}),chrome.runtime.onMessage.addListener(function(){var r=Et((function*(r){switch(r.event){case"BEGIN_PARSING":yield St();break;case"GET_RETURN_FLIGHTS":yield Ct(r.departure);break;case"HIGHLIGHT_FLIGHT":yield pt(r.selectedDepartureId,r.selectedReturnId),function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#back-to-search";if(!document.querySelector(r)){var e=document.createElement("button");e.id="back-to-search",e.textContent="Return to FlightPenguin",e.title="Click to return to FlightPenguin and keep browsing.",e.addEventListener("click",t),document.body.append(e)}}();break;case"CLEAR_SELECTION":history.back(),chrome.runtime.sendMessage({event:"EXPEDIA_READY"})}}));return function(t){return r.apply(this,arguments)}}());var St=function(){var t=Et((function*(){try{!function(t,r){chrome.runtime.sendMessage({event:"FLIGHT_RESULTS_RECEIVED",flights:r,provider:t})}("expedia",yield ot(null))}catch(t){window.Sentry.captureException(t),r("expedia",t)}}));return function(){return t.apply(this,arguments)}}(),Ct=function(){var t=Et((function*(t){yield wt(t),yield function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;return new Promise((function(r){setTimeout(r,t)}))}();try{!function(t,r){chrome.runtime.sendMessage({event:"RETURN_FLIGHTS_RECEIVED",flights:r,provider:t})}("expedia",yield ot(t))}catch(t){window.Sentry.captureException(t),r("expedia",t)}}));return function(r){return t.apply(this,arguments)}}()})()})();